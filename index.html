<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>나트랑 4박 6일 일정 (2026-02-22 ~ 2026-02-26)</title>

  <!-- Leaflet (OpenStreetMap) 지도: API Key 불필요 -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --muted:#5f6b85;
      --text:#1f2a44;
      --accent:#2f6bff;
      --accent2:#1fbf8f;
      --warn:#ff9f1a;
      --border:rgba(31,42,68,.12);
      --shadow: 0 10px 24px rgba(31,42,68,.08);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, "Apple SD Gothic Neo", sans-serif;
      background: linear-gradient(180deg, #f7f9ff 0%, #eef2ff 100%), var(--bg);
      color:var(--text);
      line-height:1.5;
    }
    header{
      padding:28px 20px 10px;
      max-width:1100px;
      margin:0 auto;
    }
    .title{
      display:flex;
      flex-wrap:wrap;
      align-items:flex-end;
      gap:10px 14px;
    }
    h1{
      margin:0;
      font-size:22px;
      letter-spacing:-.3px;
    }
    .subtitle{
      color:var(--muted);
      font-size:13px;
      margin-top:6px;
    }
    .badges{display:flex; gap:8px; flex-wrap:wrap; margin-top:12px}
    .badge{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid var(--border);
      color:var(--muted);
    }
    .badge strong{color:var(--text)}

    main{max-width:1100px; margin:0 auto; padding:16px 20px 34px}

    .tabs{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin:14px 0 14px;
    }
    .tab{
      cursor:pointer;
      user-select:none;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      font-size:13px;
      transition: .15s ease;
    }
    .tab.active{
      background: rgba(122,167,255,.18);
      color: var(--text);
      border-color: rgba(122,167,255,.35);
    }

    .panel{display:none}
    .panel.active{display:block}

    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:14px;
    }
    @media (max-width: 980px){
      .grid{grid-template-columns:1fr}
    }

    .card{
      background: #ffffff;
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:14px 16px;
      border-bottom:1px solid var(--border);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      background: linear-gradient(180deg, rgba(255,255,255,.05), transparent);
    }
    .card .hd h2{
      margin:0;
      font-size:16px;
      letter-spacing:-.2px;
    }
    .card .bd{padding:14px 16px}

    .timeline{display:flex; flex-direction:column; gap:10px}
    .item{
      border:1px solid var(--border);
      background:#f9fbff;
      border-radius: 14px;
      padding:12px 14px;
    }
    .row{
      display:flex;
      justify-content:space-between;
      gap:10px;
      align-items:flex-start;
    }
    .time{
      min-width:86px;
      font-weight:700;
      color: var(--accent);
      font-size:13px;
    }
    .desc{flex:1;color:var(--text);}
    .desc .name{font-weight:700; margin:0 0 2px 0}
    .desc .meta{color:var(--muted); font-size:12.5px}

    .pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:5px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      font-size:12px;
      margin-right:6px;
      margin-top:6px;
      white-space:nowrap;
    }

    .list{margin:0; padding-left:18px; color:var(--text)}
    .list li{margin:6px 0; color:var(--text)}
    .note{color:var(--muted); font-size:12.5px}
    .callout{
      border-left:3px solid rgba(255,204,102,.65);
      background: rgba(255,204,102,.08);
      padding:10px 12px;
      border-radius: 12px;
      color: var(--text);
      font-size:12.8px;
      margin-top:10px;
    }

    /* Map */
    #map{height: 520px; border-radius: 14px; overflow:hidden; border:1px solid var(--border)}
    .mapwrap{display:grid; grid-template-columns: 1.2fr .8fr; gap:14px}
    @media (max-width: 980px){
      .mapwrap{grid-template-columns:1fr}
      #map{height: 420px;}
    }
    .poi{
      border:1px solid var(--border);
      background:#ffffff;
      border-radius: 14px;
      padding:14px 14px;
      display:flex;
      flex-direction:column;
      gap:6px;
      box-shadow: var(--shadow);
    }
    .poi .top{display:flex; justify-content:space-between; gap:10px; align-items:flex-start}
    .poi .nm{font-weight:800;color:var(--text);}
    .poi .tag{font-size:12px; color:var(--muted)}
    .poi button{
      margin-top:6px;
      width:fit-content;
      cursor:pointer;
      padding:8px 10px;
      border-radius: 12px;
      border:1px solid rgba(122,167,255,.35);
      background: rgba(122,167,255,.14);
      color: var(--text);
      font-weight:700;
      font-size:12.5px;
    }
    .poi button:hover{filter:brightness(1.05)}

    .toolbar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-bottom:12px;
    }
    input[type="search"], select{
      background: rgba(255,255,255,.04);
      color: var(--text);
      border:1px solid var(--border);
      border-radius: 12px;
      padding:10px 10px;
      font-size:13px;
      outline:none;
      min-width: 220px;
    }
    select{min-width: 170px}
    .btn{
      cursor:pointer;
      padding:10px 12px;
      border-radius: 12px;
      border:1px solid rgba(127,240,194,.35);
      background: rgba(127,240,194,.12);
      color: var(--text);
      font-weight:800;
      font-size:13px;
    }
    .btn:hover{filter:brightness(1.06)}

    footer{
      max-width:1100px;
      margin:0 auto;
      padding:0 20px 30px;
      color: var(--muted);
      font-size:12.5px;
    }

    @media print{
      body{background:#fff; color:#000}
      header, main, footer{max-width: 100%;}
      .card{box-shadow:none; border:1px solid #ddd; background:#fff}
      .tab{display:none}
      .panel{display:block !important; page-break-inside: avoid;}
      #map{height:420px}
      .badge{border:1px solid #ddd; background:#f7f7f7; color:#333}
      .note{color:#444}
      .item,.poi{background:#fff}
    }
  </style>
</head>
<body>
  <header>
    <div class="title">
      <h1>나트랑 4박 6일 일정</h1>
      <div class="badge"><strong>기간</strong> 2026-02-22(일) 22:20 도착 ~ 2026-02-26(목) 23:20 출발</div>
    </div>
    <div class="subtitle">인원: 어르신 2(70대) · 성인 2(30대) · 유아 1(38개월). 무리 없는 동선(오전/오후 1코어 + 휴식) 기준.</div>
    <div class="badges">
      <div class="badge"><strong>권장 이동</strong> 택시/그랩(Grab) + 필요 시 전용차량</div>
      <div class="badge"><strong>핵심 컨셉</strong> 휴양 + 가벼운 시내 관광 + 1일 테마파크</div>
      <div class="badge"><strong>주의</strong> 한낮(12~15시) 휴식/실내 위주</div>
    </div>
  </header>

  <main>
    <div class="tabs" id="tabs">
      <div class="tab active" data-target="d1">2/22(일) 도착</div>
      <div class="tab" data-target="d2">2/23(월)</div>
      <div class="tab" data-target="d3">2/24(화)</div>
      <div class="tab" data-target="d4">2/25(수)</div>
      <div class="tab" data-target="d5">2/26(목) 출발</div>
      <div class="tab" data-target="transport">교통/이동</div>
      <div class="tab" data-target="maptab">지도/장소</div>
    </div>

    <!-- Day 1 -->
    <section class="panel active" id="d1">
      <div class="grid">
        <div class="card">
          <div class="hd"><h2>2/22(일) — 22:00 도착(나트랑)</h2><div class="note">목표: 체크인 + 수면 확보</div></div>
          <div class="bd">
            <div class="timeline">
              <div class="item">
                <div class="row">
                  <div class="time">22:00~</div>
                  <div class="desc">
                    <div class="name">공항 도착 → 숙소 이동</div>
                    <div class="meta">유아/어르신 고려: 픽업 사전예약(카시트/부스터 가능 여부 확인) 권장</div>
                  </div>
                </div>
                <div class="pill">이동 40~60분(지역/교통에 따라)</div>
                <div class="pill">간식/물 먼저 확보</div>
              </div>
              <div class="item">
                <div class="row">
                  <div class="time">23:30~</div>
                  <div class="desc">
                    <div class="name">체크인 · 간단 야식 · 취침</div>
                    <div class="meta">유아는 바로 샤워/수면 루틴 유지. 어르신은 다음날 컨디션 회복이 최우선.</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="callout">
              <strong>체크포인트</strong>
              <ul class="list">
                <li>현지 유심/eSIM, 그랩 결제수단, 호텔 주소(베트남어) 준비</li>
                <li>생수/간식/기저귀/상비약은 첫날 바로 확보</li>
                <li>유아 카시트가 필요하면 전용차량/렌트카 쪽이 현실적</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="hd"><h2>운영 원칙(전 일정 공통)</h2></div>
          <div class="bd">
            <ul class="list">
              <li>오전 1코어(관광/체험) + 점심/낮잠 + 오후 1코어(짧게) 구조로 운영</li>
              <li>어르신은 <strong>계단/경사</strong> 최소화(필요 시 관광택시 + 하차관광)</li>
              <li>유아는 <strong>폭염/자외선</strong> 대비(모자, 자외선차단, 물, 휴식)</li>
              <li>식사는 “검증된 곳 + 대기 짧은 곳” 우선(과식/새벽 활동 지양)</li>
            </ul>
            <div class="note">* 숙소 위치(시내/해변/섬 리조트)에 따라 이동시간이 달라질 수 있습니다.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Day 2 -->
    <section class="panel" id="d2">
      <div class="grid">
        <div class="card">
          <div class="hd"><h2>2/23(월) — 시내 적응 + 해변 산책 + 야시장</h2><div class="note">강도: 하</div></div>
          <div class="bd">
            <div class="timeline">
              <div class="item">
                <div class="row">
                  <div class="time">09:30</div>
                  <div class="desc">
                    <div class="name">Tran Phu 해변/산책(가벼운 일광욕)</div>
                    <div class="meta">유아 모래놀이 + 어르신은 그늘/카페 중심. 한낮 전 짧게.</div>
                  </div>
                </div>
                <div class="pill">우천 시: 카페/쇼핑몰로 대체</div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">12:00</div>
                  <div class="desc">
                    <div class="name">점심(현지식/한식/베트남 쌀국수 등)</div>
                    <div class="meta">유아 메뉴(국물/밥) 가능한 곳 위주.</div>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">13:30</div>
                  <div class="desc">
                    <div class="name">숙소 휴식/낮잠</div>
                    <div class="meta">어르신은 마사지(발/어깨) 정도만 가볍게.</div>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">16:00</div>
                  <div class="desc">
                    <div class="name">Long Son Pagoda + Nha Trang Cathedral(짧게)</div>
                    <div class="meta">차량 하차 후 짧은 동선만. 무리하면 1곳만 선택.</div>
                  </div>
                </div>
                <div class="pill">어르신 컨디션 낮으면 “카페 + 해변”으로 대체</div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">18:30</div>
                  <div class="desc">
                    <div class="name">Nha Trang Night Market(야시장) + 저녁</div>
                    <div class="meta">유아는 과자/과일 위주, 해산물은 익힘상태 확인. 소매치기 주의.</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="callout">
              <strong>대체안</strong>
              <ul class="list">
                <li>비/바람 강함: 야시장은 짧게, 대신 실내 쇼핑/카페</li>
                <li>어르신 피로: 사원/성당은 생략하고 저녁은 숙소 근처</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="hd"><h2>오늘의 장소(지도 탭에도 표시)</h2></div>
          <div class="bd">
            <div class="pill">Tran Phu Beach</div>
            <div class="pill">Long Son Pagoda</div>
            <div class="pill">Nha Trang Cathedral</div>
            <div class="pill">Nha Trang Night Market</div>
            <div class="note" style="margin-top:10px">* 숙소가 Tran Phu 라인(해변도로)이라면 이동 부담이 크게 줄어듭니다.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Day 3 -->
    <section class="panel" id="d3">
      <div class="grid">
        <div class="card">
          <div class="hd"><h2>2/24(화) — VinWonders(테마파크) 1일</h2><div class="note">강도: 중 (휴식/대기 고려)</div></div>
          <div class="bd">
            <div class="timeline">
              <div class="item">
                <div class="row">
                  <div class="time">09:00</div>
                  <div class="desc">
                    <div class="name">Vinpearl/VinWonders 이동(케이블카/페리)</div>
                    <div class="meta">유아는 유모차/휴대용 선풍기/우비 준비. 어르신은 대기 줄 최소화.</div>
                  </div>
                </div>
                <div class="pill">왕복 이동 포함: 하루 코어</div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">10:00</div>
                  <div class="desc">
                    <div class="name">아쿠아리움/실내 구역(우선)</div>
                    <div class="meta">한낮 더위 회피. 아이 컨디션/수면 타이밍 조절이 쉬움.</div>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">12:30</div>
                  <div class="desc">
                    <div class="name">점심(파크 내) + 휴식</div>
                    <div class="meta">식사 후 30~60분은 무조건 앉아서 쉬기(어르신 필수).</div>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">14:00</div>
                  <div class="desc">
                    <div class="name">유아/가족 동선(키즈존/가벼운 라이드/쇼)</div>
                    <div class="meta">무리한 스릴 라이드/긴 줄은 제외. 동선 짧게.</div>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">16:30</div>
                  <div class="desc">
                    <div class="name">리턴(케이블카/페리) → 숙소 휴식</div>
                    <div class="meta">저녁은 숙소 근처(또는 룸서비스)로 단순화.</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="callout">
              <strong>운영 팁(가족+어르신)</strong>
              <ul class="list">
                <li>입장권/이동수단은 가능한 사전구매(대기/줄 감소)</li>
                <li>유아 낮잠은 유모차에서 “파크 내 휴식구역”으로 해결</li>
                <li>어르신은 파크 내 동선 최소화(실내/그늘 위주)</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="hd"><h2>오늘의 장소(지도 탭에도 표시)</h2></div>
          <div class="bd">
            <div class="pill">VinWonders Nha Trang</div>
            <div class="pill">Vinpearl Cable Car Station(또는 페리 선착장)</div>
            <div class="note" style="margin-top:10px">* 케이블카 운영/대체수단(페리)은 시즌/정비에 따라 변동 가능하니 출발 전 확인 권장.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Day 4 -->
    <section class="panel" id="d4">
      <div class="grid">
        <div class="card">
          <div class="hd"><h2>2/25(수) — 머드스파 + 유적 + 선셋(가족친화)</h2><div class="note">강도: 중하</div></div>
          <div class="bd">
            <div class="timeline">
              <div class="item">
                <div class="row">
                  <div class="time">09:30</div>
                  <div class="desc">
                    <div class="name">I-Resort(또는 Thap Ba) 머드스파/온천</div>
                    <div class="meta">유아용 풀/얕은 풀 존재. 어르신은 장시간 뜨거운 탕은 피하고 중간 휴식.</div>
                  </div>
                </div>
                <div class="pill">2~3시간 코어</div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">12:30</div>
                  <div class="desc">
                    <div class="name">점심 + 숙소 휴식(필수)</div>
                    <div class="meta">머드 후에는 체력 저하가 올 수 있어 오후 일정 짧게.</div>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">16:00</div>
                  <div class="desc">
                    <div class="name">Po Nagar Cham Towers(짧게) → Hon Chong(노을)</div>
                    <div class="meta">둘 다 차량 이동 + 짧은 체류 형태로 운영. 사진/풍경 중심.</div>
                  </div>
                </div>
                <div class="pill">우천 시: Po Nagar만 짧게 또는 카페</div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">19:00</div>
                  <div class="desc">
                    <div class="name">저녁(해산물/베트남식) + 조기 귀가</div>
                    <div class="meta">다음날 늦은 출발이지만, 유아 리듬 유지가 중요.</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="callout">
              <strong>선택지</strong>
              <ul class="list">
                <li><strong>I-Resort</strong>: 가족 풀/리조트형(유아 친화)</li>
                <li><strong>Thap Ba</strong>: 전통 머드스파 느낌(시내와 가까운 편)</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="hd"><h2>오늘의 장소(지도 탭에도 표시)</h2></div>
          <div class="bd">
            <div class="pill">I-Resort Nha Trang</div>
            <div class="pill">Thap Ba Mud Bath(대체)</div>
            <div class="pill">Po Nagar Cham Towers</div>
            <div class="pill">Hon Chong Promontory</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Day 5 -->
    <section class="panel" id="d5">
      <div class="grid">
        <div class="card">
          <div class="hd"><h2>2/26(목) — 반나절 정리 + 23:00 출발</h2><div class="note">강도: 하</div></div>
          <div class="bd">
            <div class="timeline">
              <div class="item">
                <div class="row">
                  <div class="time">09:30</div>
                  <div class="desc">
                    <div class="name">Dam Market(기념품/간식) 또는 카페</div>
                    <div class="meta">사람 많은 곳: 소지품/유아 손잡기 필수. 흥정은 여유 있게.</div>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">12:00</div>
                  <div class="desc">
                    <div class="name">점심 + 숙소 복귀</div>
                    <div class="meta">체크아웃 시간 확인(늦은 체크아웃/샤워룸 문의).</div>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">13:30</div>
                  <div class="desc">
                    <div class="name">휴식/수영/짐 정리</div>
                    <div class="meta">유아 낮잠 확정. 어르신은 방에서 휴식.</div>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">18:00</div>
                  <div class="desc">
                    <div class="name">이른 저녁(소화 잘되는 메뉴) + 공항 이동 준비</div>
                    <div class="meta">출발 2~3시간 전 공항 도착 목표(교통/체크인 고려).</div>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="row">
                  <div class="time">23:00</div>
                  <div class="desc">
                    <div class="name">현지 출발</div>
                    <div class="meta">유아는 공항에서 잠들 수 있게 준비(담요/간식/기저귀).</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="callout">
              <strong>공항 이동 팁</strong>
              <ul class="list">
                <li>저녁 시간대는 이동 수요가 몰릴 수 있어 <strong>전용차량/그랩 사전예약</strong> 권장</li>
                <li>수하물/유모차 규정은 항공사별로 다르니 사전 확인</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="hd"><h2>오늘의 장소(지도 탭에도 표시)</h2></div>
          <div class="bd">
            <div class="pill">Dam Market</div>
            <div class="pill">Tran Phu Beach(짧게)</div>
            <div class="pill">Cam Ranh Airport(이동)</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Map Tab -->
    <section class="panel" id="transport">
      <div class="card">
        <div class="hd"><h2>항공편 · 주요 이동수단</h2><div class="note">실제 탑승 기준 / 가족·유아 동선 고려</div></div>
        <div class="bd">
          <div class="card" style="box-shadow:none; margin-bottom:14px">
            <div class="hd"><h2>국제선 항공편</h2></div>
            <div class="bd">
              <table style="width:100%; border-collapse:collapse; font-size:13px">
                <thead>
                  <tr style="background:#f5f7fb">
                    <th style="padding:8px; border:1px solid var(--border)">출발일자</th>
                    <th style="padding:8px; border:1px solid var(--border)">구간</th>
                    <th style="padding:8px; border:1px solid var(--border)">시간</th>
                    <th style="padding:8px; border:1px solid var(--border)">편명</th>
                    <th style="padding:8px; border:1px solid var(--border)">좌석</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td style="padding:8px; border:1px solid var(--border)">2026-02-22(일)</td>
                    <td style="padding:8px; border:1px solid var(--border)">서울(인천) → 나트랑</td>
                    <td style="padding:8px; border:1px solid var(--border)">19:00 → 22:20</td>
                    <td style="padding:8px; border:1px solid var(--border)">BX 787</td>
                    <td style="padding:8px; border:1px solid var(--border)">5석</td>
                  </tr>
                  <tr>
                    <td style="padding:8px; border:1px solid var(--border)">2026-02-26(목)</td>
                    <td style="padding:8px; border:1px solid var(--border)">나트랑 → 서울(인천)</td>
                    <td style="padding:8px; border:1px solid var(--border)">23:20 → 06:55(+1)</td>
                    <td style="padding:8px; border:1px solid var(--border)">BX 788</td>
                    <td style="padding:8px; border:1px solid var(--border)">5석</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="card" style="box-shadow:none">
            <div class="hd"><h2>현지 이동수단 가이드</h2></div>
            <div class="bd">
              <ul class="list">
                <li><strong>공항 ↔ 숙소</strong>: 전용차량 또는 Grab SUV 권장 (유아 카시트 필요 시 사전예약)</li>
                <li><strong>시내 이동</strong>: Grab 택시 중심, 단거리 위주 운영</li>
                <li><strong>VinWonders</strong>: 케이블카 또는 페리 (유모차 동반 가능 여부 현장 확인)</li>
                <li><strong>머드스파/외곽</strong>: 왕복 차량 포함 패키지 이용 시 체력 소모 최소화</li>
              </ul>
              <div class="callout">
                <strong>운영 팁</strong>
                <ul class="list">
                  <li>출발일(2/26) 밤 비행 → 오후 일정 최소화, 저녁은 공항 이동 중심</li>
                  <li>어르신/유아 동반 시 오토바이 이동은 제외</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="panel" id="maptab">
      <div class="card">
        <div class="hd"><h2>지도/장소(마커 표시)</h2><div class="note">OpenStreetMap 기반(무료). 일부 장소는 자동 지오코딩으로 좌표를 잡습니다.</div></div>
        <div class="bd">
          <div class="toolbar">
            <div id="routeSummary" class="pill" style="font-weight:700"></div>
            <input id="search" type="search" placeholder="장소 검색 (예: Po Nagar, Market, Beach)" />
            <select id="filter">
              <option value="ALL">전체</option>
              <option value="DAY_23">2/23(월) 중심</option>
              <option value="DAY_24">2/24(화) 중심</option>
              <option value="DAY_25">2/25(수) 중심</option>
              <option value="DAY_26">2/26(목) 중심</option>
            </select>
            <button class="btn" id="fit">전체 마커 보기</button>
          </div>

          <div class="mapwrap">
            <div id="map" aria-label="지도"></div>
            <div>
              <div id="poilist" style="display:flex; flex-direction:column; gap:10px"></div>
              <div class="note" style="margin-top:10px">
                * 지도 마커는 참고용입니다. 실제 운영/입장/이동은 숙소 위치와 당일 컨디션에 맞춰 조정하십시오.
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div>버전: 2026-01 기준. 본 파일은 단일 HTML로 동작하며, 인터넷 연결 시 지도 타일/자동 지오코딩이 정상 동작합니다.</div>
  </footer>

  <script>
    // ===== Tabs =====
    const tabs = Array.from(document.querySelectorAll('.tab'));
    const panels = Array.from(document.querySelectorAll('.panel'));

    function activateTab(targetId){
      tabs.forEach(t => t.classList.toggle('active', t.dataset.target === targetId));
      panels.forEach(p => p.classList.toggle('active', p.id === targetId));

      // 날짜 탭 클릭 시 지도 필터 연동
      const dayMap = { d1:'DAY_22', d2:'DAY_23', d3:'DAY_24', d4:'DAY_25', d5:'DAY_26' };
      if(dayMap[targetId]){
        const sel = document.getElementById('filter');
        if(sel){ sel.value = dayMap[targetId]; refresh(); fitAll(); }
      }

      if(targetId === 'maptab'){
        setTimeout(() => { if(window._map) window._map.invalidateSize(); fitAll(); }, 120);
      }
    }

    tabs.forEach(t => t.addEventListener('click', () => activateTab(t.dataset.target)));

    // ===== POI Data =====
    // lat/lng가 없으면 addressQuery로 Nominatim(OpenStreetMap)에서 좌표를 자동 검색합니다.
    const POIS = [
      // 2/22 (출국)
      {id:'icn_airport', name:'Incheon International Airport (ICN)', category:'Airport', day:'DAY_22', lat:37.4602, lng:126.4407, note:'19:00 BX787 출발 · 국제선 터미널'},

      // 2/23
      {id:'tran_phu_beach', name:'Tran Phu Beach', category:'Beach', day:'DAY_23', lat:12.2387911, lng:109.1967488, note:'해변 산책/가벼운 일광욕(오전 권장)'} ,
      {id:'long_son', name:'Long Son Pagoda', category:'Sight', day:'DAY_23', lat:12.2514917, lng:109.18055, note:'차량 하차관광 + 짧은 동선(계단 주의)'} ,
      {id:'cathedral', name:'Nha Trang Cathedral (Stone Church)', category:'Sight', day:'DAY_23', lat:12.2468528, lng:109.1881472, note:'짧게 둘러보기(사진/전망)'} ,
      {id:'night_market', name:'Nha Trang Night Market (Tran Phu)', category:'Market', day:'DAY_23', lat:12.2387911, lng:109.1967488, note:'Tran Phu/April 2 Square 인근. 저녁 산책 + 간식'} ,

      // 2/24
      {id:'vinwonders', name:'VinWonders Nha Trang', category:'ThemePark', day:'DAY_24', lat:12.2170479, lng:109.2408718, note:'가족/유아/어르신은 실내(아쿠아리움) 우선'} ,
      {id:'vinpearl_cable', name:'Vinpearl Cable Car Station (Nha Trang side)', category:'Transport', day:'DAY_24', addressQuery:'Vinpearl Cable Car Station, Nha Trang, Vietnam', note:'케이블카/페리 출발 지점(운영 여부는 당일 확인)'} ,

      // 2/25
      {id:'i_resort', name:'I-Resort Nha Trang (Mud Bath)', category:'Spa', day:'DAY_25', lat:12.271869, lng:109.17519, note:'가족 풀/머드/온천. 2~3시간 코어'} ,
      {id:'thap_ba', name:'Thap Ba Mud Bath (Alternative)', category:'Spa', day:'DAY_25', addressQuery:'438 Ngo Den, Ngoc Hiep, Nha Trang, Vietnam', note:'전통 머드스파 대체안'} ,
      {id:'po_nagar', name:'Po Nagar Cham Towers', category:'Sight', day:'DAY_25', lat:12.2675806, lng:109.1953583, note:'짧게 관람(계단/경사 일부)'} ,
      {id:'hon_chong', name:'Hon Chong Promontory', category:'View', day:'DAY_25', lat:12.27283, lng:109.20646, note:'노을 포인트. 바람 강하면 체류 짧게'} ,

      // 2/26
      {id:'dam_market', name:'Dam Market (Cho Dam)', category:'Market', day:'DAY_26', lat:12.254678, lng:109.191798, note:'기념품/간식 쇼핑. 소지품 주의'} ,
      {id:'cam_ranh_airport', name:'Cam Ranh International Airport (CXR)', category:'Airport', day:'DAY_26', addressQuery:'Cam Ranh International Airport, Vietnam', note:'출발 2~3시간 전 도착 목표'} ,

      // (옵션) 가족 여유날 대체
      {id:'bai_dai', name:'Bai Dai Beach (Cam Ranh)', category:'Beach', day:'ALL', lat:12.0270699, lng:109.224571, note:'여유 시 반나절(공항 근처)'}
    ];

    // ===== Map Init =====
    const map = L.map('map', {scrollWheelZoom:true});
    window._map = map;

    // 기본 중심: 나트랑 시내
    map.setView([12.24507, 109.19432], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const markers = new Map();
    const routes = new Map();

    async function geocodeNominatim(query){
      // Nominatim usage policy: 과도한 요청 방지(캐시/최소 호출)
      const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=1`;
      const res = await fetch(url, {headers: {'Accept':'application/json'}});
      if(!res.ok) return null;
      const data = await res.json();
      if(!data || !data.length) return null;
      return {lat: parseFloat(data[0].lat), lng: parseFloat(data[0].lon)};
    }

    async function ensureLatLng(p){
      if(typeof p.lat === 'number' && typeof p.lng === 'number') return {lat:p.lat, lng:p.lng};
      if(!p.addressQuery) return null;
      // 간단 캐시
      const key = `geo:${p.addressQuery}`;
      const cached = sessionStorage.getItem(key);
      if(cached){
        try{ return JSON.parse(cached); }catch(_){/* ignore */}
      }
      const ll = await geocodeNominatim(p.addressQuery);
      if(ll) sessionStorage.setItem(key, JSON.stringify(ll));
      return ll;
    }

    function makePopup(p){
      const dayLabel = ({DAY_23:'2/23(월)', DAY_24:'2/24(화)', DAY_25:'2/25(수)', DAY_26:'2/26(목)', ALL:'(옵션)'}[p.day] || '');
      return `
        <div style="font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;">
          <div style="font-weight:800; margin-bottom:4px;">${p.name}</div>
          <div style="font-size:12px; opacity:.8;">${p.category} · ${dayLabel}</div>
          <div style="font-size:12px; margin-top:6px;">${p.note || ''}</div>
        </div>
      `;
    }

    function renderPOIList(filtered){
      const wrap = document.getElementById('poilist');
      wrap.innerHTML = '';
      filtered.forEach(p => {
        const el = document.createElement('div');
        el.className = 'poi';
        const dayLabel = ({DAY_23:'2/23(월)', DAY_24:'2/24(화)', DAY_25:'2/25(수)', DAY_26:'2/26(목)', ALL:'(옵션)'}[p.day] || '');
        el.innerHTML = `
          <div class="top">
            <div>
              <div class="nm">${p.name}</div>
              <div class="tag">${p.category} · ${dayLabel}</div>
            </div>
          </div>
          <div class="note">${p.note || ''}</div>
          <button type="button" data-id="${p.id}">지도에서 보기</button>
        `;
        wrap.appendChild(el);
      });

      wrap.querySelectorAll('button').forEach(btn => {
        btn.addEventListener('click', async () => {
          const id = btn.getAttribute('data-id');
          const m = markers.get(id);
          if(!m) return;
          map.setView(m.getLatLng(), Math.max(map.getZoom(), 14));
          m.openPopup();
        });
      });
    }

    async function addMarkersOnce(){
      // 이미 추가되어 있으면 skip
      if(window._markersAdded) return;
      window._markersAdded = true;

      for(const p of POIS){
        const ll = await ensureLatLng(p);
        if(!ll) continue;
        const m = L.marker([ll.lat, ll.lng]).addTo(map).bindPopup(makePopup(p));
        markers.set(p.id, m);
        // lat/lng backfill
        p.lat = ll.lat; p.lng = ll.lng;
      }
    }

    function getFiltered(){
      const q = (document.getElementById('search').value || '').trim().toLowerCase();
      const f = document.getElementById('filter').value;
      return POIS
        .filter(p => (f === 'ALL' ? true : (p.day === f)))
        .filter(p => {
          if(!q) return true;
          const hay = `${p.name} ${p.category} ${p.note || ''}`.toLowerCase();
          return hay.includes(q);
        });
    }

    function refresh(){
      const filtered = getFiltered();
      // marker show/hide
      for(const p of POIS){
        const m = markers.get(p.id);
        if(!m) continue;
        const visible = filtered.some(x => x.id === p.id);
        if(visible){
          if(!map.hasLayer(m)) m.addTo(map);
        }else{
          if(map.hasLayer(m)) map.removeLayer(m);
        }
      }
      renderPOIList(filtered);
      drawRoutes(filtered);
    }

    function fitAll(){
      const ll = [];
      for(const p of getFiltered()){
        const m = markers.get(p.id);
        if(m) ll.push(m.getLatLng());
      }
      if(ll.length){
        const bounds = L.latLngBounds(ll);
        map.fitBounds(bounds.pad(0.22));
      }
    }

    // ===== Route (Polyline) Data =====
    // ===== Route (Polyline) Data with time & mode =====
    const ROUTES = {
      DAY_22: [
        {from:'icn_airport', to:'cam_ranh_airport', time:'19:00', mode:'plane'}
      ],
      DAY_23: [
        {from:'tran_phu_beach', to:'long_son', time:'09:30', mode:'car'},
        {from:'long_son', to:'cathedral', time:'16:00', mode:'walk'},
        {from:'cathedral', to:'night_market', time:'18:30', mode:'car'}
      ],
      DAY_24: [
        {from:'vinpearl_cable', to:'vinwonders', time:'09:00', mode:'cable'}
      ],
      DAY_25: [
        {from:'i_resort', to:'po_nagar', time:'16:00', mode:'car'},
        {from:'po_nagar', to:'hon_chong', time:'17:00', mode:'car'}
      ],
      DAY_26: [
        {from:'dam_market', to:'cam_ranh_airport', time:'18:00', mode:'car'}
      ]
    };

    function drawRoutes(filtered){
      for(const obj of routes.values()){
        if(obj.poly) map.removeLayer(obj.poly);
        if(obj.label) map.removeLayer(obj.label);
      }
      routes.clear();

      let totalDist = 0;
      let totalMin = 0;

      const days = new Set(filtered.map(p=>p.day));
      days.forEach(day=>{
        if(!ROUTES[day]) return;
        ROUTES[day].forEach(seg=>{
          const m1 = markers.get(seg.from);
          const m2 = markers.get(seg.to);
          if(!m1 || !m2) return;

          const latlngs = [m1.getLatLng(), m2.getLatLng()];
          const colorMap = { walk:'#1fbf8f', car:'#2f6bff', cable:'#8b5cf6', plane:'#ff9f1a' };
          const poly = L.polyline(latlngs, {
            color: colorMap[seg.mode] || '#2f6bff',
            weight: 5,
            opacity: 0.85
          }).addTo(map);

          const dist = map.distance(latlngs[0], latlngs[1]);
          const speedMap = { walk:4, car:30, cable:20, plane:800 };
          const minutes = Math.round((dist/1000)/(speedMap[seg.mode]||30)*60);

          totalDist += dist;
          totalMin += minutes;

          const mid = L.latLng(
            (latlngs[0].lat + latlngs[1].lat)/2,
            (latlngs[0].lng + latlngs[1].lng)/2
          );

          const label = L.marker(mid, {
            interactive:false,
            icon: L.divIcon({
              className:'',
              html:`<div style=\"background:#fff;border:1px solid rgba(0,0,0,.15);border-radius:10px;padding:4px 8px;font-size:11px;white-space:nowrap\">${seg.time} · ${minutes}분</div>`
            })
          }).addTo(map);

          routes.set(`${day}-${seg.from}-${seg.to}`, {poly, label});
        });
      });

      const sumBox = document.getElementById('routeSummary');
      if(sumBox){
        sumBox.innerHTML = `총 이동거리 ${(totalDist/1000).toFixed(1)} km · 총 이동시간 ${totalMin} 분`;
      }
    }

    // init
    (async () => {
      await addMarkersOnce();
      refresh();
      fitAll();
    })();

    document.getElementById('search').addEventListener('input', refresh);
    document.getElementById('filter').addEventListener('change', () => { refresh(); fitAll(); });
    document.getElementById('fit').addEventListener('click', fitAll);

    // 지도 탭으로 처음 들어갈 때 레이아웃 깨짐 방지
    document.querySelector('[data-target="maptab"]').addEventListener('click', () => {
      setTimeout(() => { map.invalidateSize(); fitAll(); }, 120);
    });
  </script>
</body>
</html>
